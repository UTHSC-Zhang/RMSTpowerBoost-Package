<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Analyze Power for a Linear RMST Model (Analytic) — linear.power.analytical • RMSTpowerBoost</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Analyze Power for a Linear RMST Model (Analytic) — linear.power.analytical"><meta name="description" content="Performs power analysis using a direct formula based on the
asymptotic variance estimator for the linear RMST model."><meta property="og:description" content="Performs power analysis using a direct formula based on the
asymptotic variance estimator for the linear RMST model."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">RMSTpowerBoost</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/RMSTpowerBoost-Main.html">R Package</a></li>
<li class="nav-item"><a class="nav-link" href="../articles/RMSTpowerBoost-DataGen.html">Data Generation</a></li>
<li class="nav-item"><a class="nav-link" href="../articles/RMSTpowerBoost-App.html">Application</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><a class="external-link nav-link" href="https://github.com/UTHSC-Zhang/RMSTpowerBoost-Package/issues">Issues</a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/UTHSC-Zhang/RMSTpowerBoost-Package/discussions">Discussions</a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Analyze Power for a Linear RMST Model (Analytic)</h1>
      <small class="dont-index">Source: <a href="https://github.com/UTHSC-Zhang/RMSTpowerBoost-Package/blob/main/R/linear_ipcw_analytical.R" class="external-link"><code>R/linear_ipcw_analytical.R</code></a></small>
      <div class="d-none name"><code>linear.power.analytical.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Performs power analysis using a direct formula based on the
asymptotic variance estimator for the linear RMST model.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">linear.power.analytical</span><span class="op">(</span></span>
<span>  <span class="va">pilot_data</span>,</span>
<span>  <span class="va">time_var</span>,</span>
<span>  <span class="va">status_var</span>,</span>
<span>  <span class="va">arm_var</span>,</span>
<span>  <span class="va">sample_sizes</span>,</span>
<span>  linear_terms <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">L</span>,</span>
<span>  alpha <span class="op">=</span> <span class="fl">0.05</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-pilot-data">pilot_data<a class="anchor" aria-label="anchor" href="#arg-pilot-data"></a></dt>
<dd><p>A <code>data.frame</code> containing pilot study data.</p></dd>


<dt id="arg-time-var">time_var<a class="anchor" aria-label="anchor" href="#arg-time-var"></a></dt>
<dd><p>A character string specifying the name of the time-to-event variable.</p></dd>


<dt id="arg-status-var">status_var<a class="anchor" aria-label="anchor" href="#arg-status-var"></a></dt>
<dd><p>A character string specifying the name of the event status variable (1=event, 0=censored).</p></dd>


<dt id="arg-arm-var">arm_var<a class="anchor" aria-label="anchor" href="#arg-arm-var"></a></dt>
<dd><p>A character string specifying the name of the treatment arm variable (1=treatment, 0=control).</p></dd>


<dt id="arg-sample-sizes">sample_sizes<a class="anchor" aria-label="anchor" href="#arg-sample-sizes"></a></dt>
<dd><p>A numeric vector of sample sizes <em>per arm</em> to calculate power for.</p></dd>


<dt id="arg-linear-terms">linear_terms<a class="anchor" aria-label="anchor" href="#arg-linear-terms"></a></dt>
<dd><p>An optional character vector of other covariate names to include in the model.</p></dd>


<dt id="arg-l">L<a class="anchor" aria-label="anchor" href="#arg-l"></a></dt>
<dd><p>The numeric value for the RMST truncation time.</p></dd>


<dt id="arg-alpha">alpha<a class="anchor" aria-label="anchor" href="#arg-alpha"></a></dt>
<dd><p>The significance level for the power calculation (Type I error rate).</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A <code>list</code> containing:</p>
<dl><dt>results_data</dt>
<dd><p>A <code>data.frame</code> with the specified sample sizes and their corresponding calculated power.</p></dd>

<dt>results_plot</dt>
<dd><p>A <code>ggplot</code> object visualizing the power curve.</p></dd>

<dt>results_summary</dt>
<dd><p>A <code>data.frame</code> summarizing the treatment effect from the pilot data used for the calculation.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>This function implements the analytic power calculation for the direct linear
regression model of the Restricted Mean Survival Time (RMST) proposed by Tian et al. (2014).
The core of the method is a weighted linear model of the form
$$E[Y_i|Z_i] = \beta_0 + \beta_1 Z_i$$
where \(Y_i = \min(T_i, \L)\) is the event time truncated at \(\L\).</p>
<p>To handle right-censoring, the method uses Inverse Probability of Censoring
Weighting (IPCW). The weight for an uncensored individual <code>i</code> is the inverse
of the probability of remaining uncensored until their event time, \(w_i = \delta_i / \hat{G}(Y_i)\),
where \(\hat{G}(t) = P(C &gt; t)\) is the Kaplan-Meier estimate of the censoring distribution.</p>
<p>Power is calculated analytically based on the asymptotic properties of the
coefficient estimators. The variance of the treatment effect estimator, \(\hat{\beta}\), is derived from a
robust sandwich variance estimator of the form \(A^{-1}B(A^{-1})'\). In this implementation,
<code>A</code> is the scaled information matrix \((X'WX)/n\), and <code>B</code> is the empirical second moment of the
influence functions, \((\sum \epsilon_i \epsilon_i')/n\), where \(\epsilon_i\) is the influence curve
for observation <code>i</code>. The resulting variance is used to calculate the standard error for a
given sample size, which in turn is used in the power formula.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">pilot_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  time <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Exponential.html" class="external-link">rexp</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">0.1</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  status <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html" class="external-link">rbinom</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">1</span>, <span class="fl">0.7</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  arm <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="fl">1</span>, each <span class="op">=</span> <span class="fl">50</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  age <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">55</span>, <span class="fl">10</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">power_results</span> <span class="op">&lt;-</span> <span class="fu">linear.power.analytical</span><span class="op">(</span></span></span>
<span class="r-in"><span>  pilot_data <span class="op">=</span> <span class="va">pilot_df</span>,</span></span>
<span class="r-in"><span>  time_var <span class="op">=</span> <span class="st">"time"</span>,</span></span>
<span class="r-in"><span>  status_var <span class="op">=</span> <span class="st">"status"</span>,</span></span>
<span class="r-in"><span>  arm_var <span class="op">=</span> <span class="st">"arm"</span>,</span></span>
<span class="r-in"><span>  linear_terms <span class="op">=</span> <span class="st">"age"</span>,</span></span>
<span class="r-in"><span>  sample_sizes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">200</span>, <span class="fl">300</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  L <span class="op">=</span> <span class="fl">10</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> --- Estimating parameters from pilot data for analytic calculation... ---</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Model: Y_rmst ~ factor(arm) + age</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> --- Calculating asymptotic variance... ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> --- Calculating power for specified sample sizes... ---</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">power_results</span><span class="op">$</span><span class="va">results_data</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   N_per_Arm      Power</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1       100 0.03084095</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2       200 0.03357109</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3       300 0.03579832</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">power_results</span><span class="op">$</span><span class="va">results_plot</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="linear.power.analytical-1.png" alt="" width="700" height="433"></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Arnab Aich, Yuan Zhang.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

